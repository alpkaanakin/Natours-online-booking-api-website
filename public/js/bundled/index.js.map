{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/updateSettings.js","public/js/index.js","public/js/login.js","public/js/signup.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\nexport const displayMap = locations => {\n  mapboxgl.accessToken =\n    'pk.eyJ1IjoiYmx1ZS1tYWdpc3RlciIsImEiOiJjbDF4ejluMngwN3N6M2NucjI1ejM2czFjIn0.PbZCOpY4YJwANReSDDC72w';\n\n  var map = new mapboxgl.Map({\n    container: 'map',\n    style: 'mapbox://styles/blue-magister/cl20p5gef009h14nuj5pnvikk',\n    scrollZoom: false\n    // center: [-118.113491, 34.111745],\n    // zoom: 10,\n    // interactive: false\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  locations.forEach(loc => {\n    // Create marker\n    const el = document.createElement('div');\n    el.className = 'marker';\n\n    // Add marker\n    new mapboxgl.Marker({\n      element: el,\n      anchor: 'bottom'\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n\n    // Add popup\n    new mapboxgl.Popup({\n      offset: 30\n    })\n      .setLngLat(loc.coordinates)\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\n      .addTo(map);\n\n    // Extend map bounds to include current location\n    bounds.extend(loc.coordinates);\n  });\n\n  map.fitBounds(bounds, {\n    padding: {\n      top: 200,\n      bottom: 150,\n      left: 100,\n      right: 100\n    }\n  });\n};\n","/* eslint-disable */\n\nexport const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","/* eslint-disable */\nimport { showAlert } from './alerts';\n\n// type is either 'password' or 'data'\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === 'password'\n        ? '/api/users/updatepassword'\n        : '/api/users/updateMe';\n\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data\n    });\n    console.log(data)\n\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\n      location.reload(true);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n","/* eslint-disable */\nimport { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport {signUp} from \"./signup\"\nimport { updateSettings } from './updateSettings';\nimport {bookTour} from \"./stripe\";\n\n// DOM ELEMENTS\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst signUpForm = document.querySelector(\".form--sign-up\");\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookBtn = document.querySelector(\"#book-tour\")\n\n// DELEGATION\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm)\n  loginForm.addEventListener('submit', e => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login(email, password);\n    \n  });\n\n  if (signUpForm)\n  signUpForm.addEventListener('submit', e => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const username = document.getElementById('username').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    signUp(email, username,password,passwordConfirm);\n    \n  });\n\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\n\nif (userDataForm)\n  userDataForm.addEventListener('submit', e => {\n    e.preventDefault();\n    const form = new FormData();\n    form.append(\"photo\", document.getElementById(\"photo\").files[0])\n    updateSettings(form, 'data');\n  });\n\nif (userPasswordForm)\n  userPasswordForm.addEventListener('submit', async e => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const currentPassword = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings(\n      { currentPassword, password, passwordConfirm },\n      'password'\n    );\n\n\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n\n  if(bookBtn) {bookBtn.addEventListener(\"click\",e=>{\n    e.target.textContent = \"Processing....\"\n    const {tourId} = e.target.dataset;\n    bookTour(tourId)\n\n  })}\n","/* eslint-disable */\nimport { showAlert } from './alerts';\n\nexport const login = async (email, password) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/users/login',\n      data: {\n        email,\n        password\n      }\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Logged in successfully!');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/users/logout'\n    });\n    if ((res.data.status = 'success')) location.reload(true);\n  } catch (err) {\n    showAlert('error', 'Error logging out! Try again.');\n  }\n};\n","/* eslint-disable */\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const signUp = async (email, username, password,passwordConfirm) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/users/signup',\n      data: {\n        email,\n        name:username,\n        password,\n        passwordConfirm\n      }\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Logged in successfully!');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};","/* eslint-disable */\nimport { showAlert } from \"./alerts\"\n\nexport const bookTour = async tourId => {\n  // Get CheckOut Session\n  try{\n  const stripe = Stripe(\n  \"pk_test_51KsGGVAnKHqafT4Bs5ZFe7xKsJdr0FmJaX6ro5JZb9v7kYLCSuasQ1MtRuMnGFOy2daE7MzbDRifvxf58LQRaFUT00SbeoSdn3\"\n);\n\n  const session = await axios(`/api/booking/checkout-session/${tourId}`);\n\n\n  // Create checkout  form + chanre credit card\n  await stripe.redirectToCheckout({\n    sessionId: session.data.session.id\n  })\n\n  }catch(err) {console.log(err); showAlert(\"error\",err)}\n\n\n}"],"names":["$20603af1a693aea3$export$516836c6a9dfc573","el","document","querySelector","parentElement","removeChild","$20603af1a693aea3$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$84820da36d2ac05b$export$f558026a994b6051","async","data","url","res","axios","method","console","log","status","toUpperCase","location","reload","err","response","message","$c4635b4cab66a4fa$var$mapBox","getElementById","$c4635b4cab66a4fa$var$loginForm","$c4635b4cab66a4fa$var$signUpForm","$c4635b4cab66a4fa$var$logOutBtn","$c4635b4cab66a4fa$var$userDataForm","$c4635b4cab66a4fa$var$userPasswordForm","$c4635b4cab66a4fa$var$bookBtn","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","loc","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$c7e555e92c1f0c6d$export$4c5dd147b21b9176","JSON","parse","dataset","addEventListener","e","preventDefault","email","password","assign","$33c301f33eb33078$export$596d806903d1f59e","value","username","passwordConfirm","$l7YK1$axios","name","$267838100e2f4b3f$export$cf64224bcd829024","form","FormData","append","files","textContent","currentPassword","target","tourId","stripe","Stripe","session","redirectToCheckout","sessionId","id","$6ff2b273ce18384b$export$8d5bdbf26681c0c2"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}